<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª</title>

<style>
:root{
 --bg:#f4f6f9;--card:#fff;--main:#1976d2;--text:#000;
 --warn:#fff3cd;--danger:#f8d7da;--unpaid:#f5c6cb;
}
body{
 font-family:Arial;background:var(--bg);color:var(--text);
 padding:20px;transition:.3s
}
.dark{--bg:#121212;--card:#1e1e1e;--text:#eee}
h2{text-align:center;color:var(--main)}
.card{background:var(--card);padding:15px;border-radius:8px;margin-bottom:15px}
input,select,button,textarea{
 width:100%;padding:10px;margin:5px 0;border-radius:5px
}
button{background:var(--main);color:#fff;border:none;cursor:pointer}
table{width:100%;border-collapse:collapse}
th,td{border:1px solid #ccc;padding:8px;text-align:center}
th{background:var(--main);color:#fff}
.warn{background:var(--warn)}
.danger{background:var(--danger)}
.unpaid{background:var(--unpaid)!important}
.actions button{margin:2px;padding:5px}
.top{display:flex;gap:10px;flex-wrap:wrap}
</style>
</head>

<body>

<div class="top">
  <button onclick="toggleMode()">ğŸŒ™ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ</button>
  <input id="search" placeholder="Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ù‡Ø§ØªÙ" onkeyup="render()">
</div>

<h2>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª</h2>

<!-- PROFIL -->
<div class="card">
<strong>ğŸ‘¤ Profil</strong>
<input id="pname" placeholder="Ø§Ø³Ù…Ùƒ">
<input id="pphone" placeholder="Ù‡Ø§ØªÙÙƒ">
<textarea id="pnote" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø©"></textarea>
<button onclick="saveProfile()">ğŸ’¾ Ø­ÙØ¸</button>
</div>

<div class="card">
  <input id="name" placeholder="Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†">
  <input id="phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
  <input id="email" placeholder="E-mail">
  <select id="product">
    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†ØªØ¬</option>
    <option>Netflix</option>
    <option>Shahid</option>
    <option>IPTV</option>
  </select>
  <input id="price" type="number" placeholder="Ø§Ù„Ø³Ø¹Ø± (Ø¯Ø¬)">
  <input id="days" type="number" placeholder="Ø§Ù„Ù…Ø¯Ø© Ø¨Ø§Ù„Ø£ÙŠØ§Ù…">
  <select id="paid">
    <option value="true">Ù…Ø¯ÙÙˆØ¹ âœ…</option>
    <option value="false">ØºÙŠØ± Ù…Ø¯ÙÙˆØ¹ âŒ</option>
  </select>
  <button onclick="add()">â• Ø¥Ø¶Ø§ÙØ©</button>
</div>

<div class="card">
<table>
<thead>
<tr>
<th>Ø§Ù„Ø§Ø³Ù…</th>
<th>Ø§Ù„Ù‡Ø§ØªÙ</th>
<th>Ø§Ù„Ù…Ù†ØªØ¬</th>
<th>Ø§Ù„Ø³Ø¹Ø±</th>
<th>Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡</th>
<th>Ø§Ù„Ø¯ÙØ¹</th>
<th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
</tr>
</thead>
<tbody id="list"></tbody>
</table>
</div>

<script>
let subs = JSON.parse(localStorage.getItem("subs")||"[]");
let profile = JSON.parse(localStorage.getItem("profile")||"{}");

function save(){localStorage.setItem("subs",JSON.stringify(subs));}
function fmt(d){return d.getFullYear()+"/"+String(d.getMonth()+1).padStart(2,"0")+"/"+String(d.getDate()).padStart(2,"0");}

function saveProfile(){
 profile={
  name:pname.value,
  phone:pphone.value,
  note:pnote.value
 };
 localStorage.setItem("profile",JSON.stringify(profile));
 alert("ØªÙ… Ø­ÙØ¸ Profil");
}

function loadProfile(){
 pname.value=profile.name||"";
 pphone.value=profile.phone||"";
 pnote.value=profile.note||"";
}

function add(){
 if(!name.value||!phone.value||!product.value||!price.value||!days.value){
  alert("Ø§Ù…Ù„Ø£ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„");return;
 }
 let end=new Date();
 end.setDate(end.getDate()+ +days.value);

 subs.push({
  id:Date.now(),
  name:name.value,
  phone:phone.value,
  email:email.value,
  product:product.value,
  price:+price.value,
  paid:paid.value==="true",
  end:end.toISOString()
 });
 save();render();
 name.value=phone.value=email.value=product.value=price.value=days.value="";
 paid.value="true";
}

function render(){
 list.innerHTML="";
 let q=search.value.toLowerCase();
 let today=new Date();

 subs.forEach(s=>{
  if(q && !(`${s.name} ${s.phone}`.toLowerCase().includes(q))) return;
  let end=new Date(s.end);
  let diff=Math.ceil((end-today)/86400000);
  let tr=document.createElement("tr");

  if(!s.paid) tr.classList.add("unpaid");
  if(diff<=0) tr.classList.add("danger");
  else if(diff<=3) tr.classList.add("warn");

  tr.innerHTML=`
<td>${s.name}</td>
<td>${s.phone}</td>
<td>${s.product}</td>
<td>${s.price} Ø¯Ø¬</td>
<td>${fmt(end)}</td>
<td>${s.paid?"âœ…":"âŒ"}</td>
<td class="actions">
 <button onclick="edit(${s.id})">âœï¸</button>
 <button onclick="del(${s.id})">ğŸ—‘</button>
</td>`;
  list.appendChild(tr);
 });
}

function edit(id){
 let s=subs.find(x=>x.id===id);
 let n=prompt("Ø§Ù„Ø§Ø³Ù…",s.name);
 let p=prompt("Ø§Ù„Ù‡Ø§ØªÙ",s.phone);
 let e=prompt("Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„",s.email);
 let pr=prompt("Ø§Ù„Ù…Ù†ØªØ¬",s.product);
 let priceNew=prompt("Ø§Ù„Ø³Ø¹Ø±",s.price);
 let daysNew=prompt("Ø§Ù„Ù…Ø¯Ø© Ø¨Ø§Ù„Ø£ÙŠØ§Ù…",30);
 let paidNew=confirm("Ù‡Ù„ Ù…Ø¯ÙÙˆØ¹ØŸ");

 if(n) s.name=n;
 if(p) s.phone=p;
 if(e) s.email=e;
 if(pr) s.product=pr;
 if(priceNew) s.price=+priceNew;
 if(daysNew){
  let d=new Date();
  d.setDate(d.getDate()+ +daysNew);
  s.end=d.toISOString();
 }
 s.paid=paidNew;
 save();render();
}

function del(id){
 if(!confirm("Ø­Ø°Ù Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØŸ"))return;
 subs=subs.filter(x=>x.id!==id);
 save();render();
}

function toggleMode(){document.body.classList.toggle("dark");}

loadProfile();
render();
</script>

</body>
</html>
